<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
         "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<script type="text/javascript"
  src="http://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<title>GAP (JupyterViz) - Chapter 2: Function reference</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta name="generator" content="GAPDoc2HTML" />
<link rel="stylesheet" type="text/css" href="manual.css" />
<script src="manual.js" type="text/javascript"></script>
<script type="text/javascript">overwriteStyle();</script>
</head>
<body class="chap2"  onload="jscontent()">


<div class="chlinktop"><span class="chlink1">Goto Chapter: </span><a href="chap0_mj.html">Top</a>  <a href="chap1_mj.html">1</a>  <a href="chap2_mj.html">2</a>  <a href="chap3_mj.html">3</a>  <a href="chapInd_mj.html">Ind</a>  </div>

<div class="chlinkprevnexttop">&nbsp;<a href="chap0_mj.html">[Top of Book]</a>&nbsp;  <a href="chap0_mj.html#contents">[Contents]</a>&nbsp;  &nbsp;<a href="chap1_mj.html">[Previous Chapter]</a>&nbsp;  &nbsp;<a href="chap3_mj.html">[Next Chapter]</a>&nbsp;  </div>

<p id="mathjaxlink" class="pcenter"><a href="chap2.html">[MathJax off]</a></p>
<p><a id="X7ECCCA82839EA283" name="X7ECCCA82839EA283"></a></p>
<div class="ChapSects"><a href="chap2_mj.html#X7ECCCA82839EA283">2 <span class="Heading">Function reference</span></a>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap2_mj.html#X784AA528839119B9">2.1 <span class="Heading">Public API</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X78BDA43D7E633E33">2.1-1 RunJavaScript</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X81E2B3A07EA7A02B">2.1-2 LoadJavaScriptFile</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X7BFFD8B7808F5BDA">2.1-3 CreateVisualization</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap2_mj.html#X7B106BA97FD3C2BF">2.2 <span class="Heading">Internal methods</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X7FA27984822A0E5E">2.2-1 JUPVIZAbsoluteJavaScriptFilename</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X7F877B4279081217">2.2-2 JUPVIZLoadedJavaScriptCache</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X84F0A3C97FBC57EE">2.2-3 JUPVIZFillInJavaScriptTemplate</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X8603271979CCFA2A">2.2-4 JUPVIZRunJavaScriptFromTemplate</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X804379D07F29E905">2.2-5 JUPVIZRunJavaScriptUsingRunGAP</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X79B7692C7F543161">2.2-6 JUPVIZRunJavaScriptUsingLibraries</a></span>
</div></div>
<div class="ContSect"><span class="tocline"><span class="nocss">&nbsp;</span><a href="chap2_mj.html#X7CB82ABE7B3255EB">2.3 <span class="Heading">Representation wrapper</span></a>
</span>
<div class="ContSSBlock">
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X82269732822D224D">2.3-1 JUPVIZIsFileContents</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X84D70ACD7A72AA84">2.3-2 JUPVIZIsFileContentsRep</a></span>
<span class="ContSS"><br /><span class="nocss">&nbsp;&nbsp;</span><a href="chap2_mj.html#X7D401DB582A5EBA2">2.3-3 JUPVIZFileContents</a></span>
</div></div>
</div>

<h3>2 <span class="Heading">Function reference</span></h3>

<p><a id="X784AA528839119B9" name="X784AA528839119B9"></a></p>

<h4>2.1 <span class="Heading">Public API</span></h4>

<p><a id="X78BDA43D7E633E33" name="X78BDA43D7E633E33"></a></p>

<h5>2.1-1 RunJavaScript</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; RunJavaScript</code>( <var class="Arg">script</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: an object that, if rendered in a Jupyter notebook, will run <var class="Arg">script</var> as JavaScript</p>

<p>If evaluated in a Jupyter notebook, its result, when rendered by that notebook, will run the JavaScript code in <var class="Arg">script</var>.</p>

<p>When the given code is run, the varible <code class="code">element</code> will be defined in its environment, and will contain the output element in the Jupyter notebook corresponding to the code that was just evaluated. The script is free to write to that output element.</p>

<p>This function is not intended for use in the <strong class="pkg">GAP</strong> REPL.</p>

<p><a id="X81E2B3A07EA7A02B" name="X81E2B3A07EA7A02B"></a></p>

<h5>2.1-2 LoadJavaScriptFile</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; LoadJavaScriptFile</code>( <var class="Arg">filename</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: the string contents of the file whose name is given</p>

<p>Interprets the given <var class="Arg">filename</var> relative to the <code class="file">lib/js/</code> path in the JupyterViz package's installation folder, because that is where this package stores its JavaScript libraries. A <code class="file">.js</code> extension will be added to <var class="Arg">filename</var> iff needed. A <code class="file">.min.js</code> extension will be added iff such a file exists, to prioritize minified versions of files.</p>

<p>If the file has been loaded before in this <strong class="pkg">GAP</strong> session, it will not be reloaded, but will be returned from a cache in memory, for efficiency.</p>

<p>If no such file exists, returns <code class="keyw">fail</code> and caches nothing.</p>

<p><a id="X7BFFD8B7808F5BDA" name="X7BFFD8B7808F5BDA"></a></p>

<h5>2.1-3 CreateVisualization</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; CreateVisualization</code>( <var class="Arg">data</var>[, <var class="Arg">code</var>] )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: an object that, if rendered in a Jupyter notebook, will run a script to create the desired visualization</p>

<p>The <var class="Arg">data</var> must be a record that will be converted to JSON using <strong class="pkg">GAP</strong>'s <strong class="pkg">json</strong> package.</p>

<p>The second argument is optional, a string containing JavaScript <var class="Arg">code</var> to run once the visualization has been created. When that code is run, the variables <code class="code">element</code> and <code class="code">visualization</code> will be in its environment, the former holding the output element in the notebook containing the visualization, and the latter holding the visualization element itself.</p>

<p>The <var class="Arg">data</var> should have the following attributes.</p>


<ul>
<li><p><code class="code">tool</code> (required) - the name of the visualization tool to use. Currently supported tools:</p>


<ul>
<li><p><code class="code">anychart</code>, whose JSON data format is given here:</p>

<p><span class="URL"><a href="https://docs.anychart.com/Working_with_Data/Data_From_JSON">https://docs.anychart.com/Working_with_Data/Data_From_JSON</a></span></p>

</li>
<li><p><code class="code">canvas</code>, that is, a regular HTML canvas element, on which you can draw using arbitrary JavaScript included in the <var class="Arg">code</var> parameter</p>

</li>
<li><p><code class="code">canvasjs</code>, whose JSON data format is given here:</p>

<p><span class="URL"><a href="https://canvasjs.com/docs/charts/chart-types/">https://canvasjs.com/docs/charts/chart-types/</a></span></p>

</li>
<li><p><code class="code">chartjs</code>, whose JSON data format is given here:</p>

<p><span class="URL"><a href="http://www.chartjs.org/docs/latest/getting-started/usage.html">http://www.chartjs.org/docs/latest/getting-started/usage.html</a></span></p>

</li>
<li><p><code class="code">cytoscape</code>, whose JSON data format is given here:</p>

<p><span class="URL"><a href="http://js.cytoscape.org/#notation/elements-json">http://js.cytoscape.org/#notation/elements-json</a></span></p>

</li>
<li><p><code class="code">d3</code>, which is loaded into an SVG element in the notebook's output cell, and the caller can call any D3 methods on that element thereafter, using arbitrary JavaScript included in the <var class="Arg">code</var> parameter</p>

</li>
<li><p><code class="code">html</code>, which fills the output element with arbitrary HTML, which the caller should provide as a string in the <code class="code">html</code> field of <var class="Arg">data</var>, as documented below</p>

</li>
<li><p><code class="code">plotly</code>, whose JSON data format is given here:</p>

<p><span class="URL"><a href="https://plot.ly/javascript/plotlyjs-function-reference/#plotlynewplot">https://plot.ly/javascript/plotlyjs-function-reference/#plotlynewplot</a></span></p>

</li>
</ul>
</li>
<li><p><code class="code">data</code> (required) - subobject containing all options specific to the content of the visualization, often passed intact to the external JavaScript visualization library. You should prepare this data in the format required by the library specified in the <code class="code">tool</code> field, following the documentation for that library cited above.</p>

</li>
<li><p><code class="code">width</code> (optional) - width to set on the output element being created</p>

</li>
<li><p><code class="code">height</code> (optional) - similar, but height</p>

</li>
</ul>

<div class="example"><pre>
CreateVisualization( rec(
    tool := "html",
    data := rec( html := "I am &lt;i&gt;SO&lt;/i&gt; excited about this." )
), "console.log( 'Visualization created.' );" );
</pre></div>

<p><a id="X7B106BA97FD3C2BF" name="X7B106BA97FD3C2BF"></a></p>

<h4>2.2 <span class="Heading">Internal methods</span></h4>

<p>Using the convention common to <strong class="pkg">GAP</strong> packages, we prefix all methods not intended for public use with a sequence of characters that indicate our particular package. In this case, we use the <code class="code">JUPVIZ</code> prefix. This is a sort of "poor man's namespacing."</p>

<p><em>None of these methods should need to be called by a client of this package. We provide this documentation here for completeness, not out of necessity.</em></p>

<p><a id="X7FA27984822A0E5E" name="X7FA27984822A0E5E"></a></p>

<h5>2.2-1 JUPVIZAbsoluteJavaScriptFilename</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; JUPVIZAbsoluteJavaScriptFilename</code>( <var class="Arg">filename</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: a JavaScript filename to an absolute path in the package dir</p>

<p>Given a relative <var class="Arg">filename</var>, convert it into an absolute filename by prepending the path to the <code class="file">lib/js/</code> folder within the JupyterViz package's installation folder. This is used by functions that need to find JavaScript files stored there.</p>

<p>A <code class="file">.js</code> extension is appended if none is included in the given <var class="Arg">filename</var>.</p>

<p><a id="X7F877B4279081217" name="X7F877B4279081217"></a></p>

<h5>2.2-2 JUPVIZLoadedJavaScriptCache</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; JUPVIZLoadedJavaScriptCache</code></td><td class="tdright">(&nbsp;global variable&nbsp;)</td></tr></table></div>
<p>A cache of the contents of any JavaScript files that have been loaded from this package's folder. The existence of this cache means needing to go to the filesystem for these files only once per <strong class="pkg">GAP</strong> session. This cache is used by <code class="func">LoadJavaScriptFile</code> (<a href="chap2_mj.html#X81E2B3A07EA7A02B"><span class="RefLink">2.1-2</span></a>).</p>

<p><a id="X84F0A3C97FBC57EE" name="X84F0A3C97FBC57EE"></a></p>

<h5>2.2-3 JUPVIZFillInJavaScriptTemplate</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; JUPVIZFillInJavaScriptTemplate</code>( <var class="Arg">filename</var>, <var class="Arg">dictionary</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: a string containing the contents of the given template file, filled in using the given dictionary</p>

<p>A template file is one containing identifiers that begin with a dollar sign (<code class="code">$</code>). For example, <code class="code">$one</code> and <code class="code">$two</code> are both identifiers. One "fills in" the template by replacing such identifiers with whatever text the caller associates with them.</p>

<p>This function loads the file specified by <var class="Arg">filename</var> by passing that argument directly to <code class="func">LoadJavaScriptFile</code> (<a href="chap2_mj.html#X81E2B3A07EA7A02B"><span class="RefLink">2.1-2</span></a>). If no such file exists, returns <code class="keyw">fail</code>. Otherwise, it proceed as follows.</p>

<p>For each key-value pair in the given <var class="Arg">dictionary</var>, prefix a <code class="code">$</code> onto the key, suffix a newline character onto the value, and then replace all occurrences of the new key with the new value. The resulting string is the result.</p>

<p>The newline character is included so that if any of the values in the <var class="Arg">dictionary</var> contains single-line JavaScript comment characters (<code class="code">//</code>) then they will not inadvertently affect later code in the template.</p>

<p><a id="X8603271979CCFA2A" name="X8603271979CCFA2A"></a></p>

<h5>2.2-4 JUPVIZRunJavaScriptFromTemplate</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; JUPVIZRunJavaScriptFromTemplate</code>( <var class="Arg">filename</var>, <var class="Arg">dictionary</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: the composition of <code class="func">RunJavaScript</code> (<a href="chap2_mj.html#X78BDA43D7E633E33"><span class="RefLink">2.1-1</span></a>) with <code class="func">JUPVIZFillInJavaScriptTemplate</code> (<a href="chap2_mj.html#X84F0A3C97FBC57EE"><span class="RefLink">2.2-3</span></a>)</p>

<p>This function is quite simple, and is just a convenience function</p>

<p><a id="X804379D07F29E905" name="X804379D07F29E905"></a></p>

<h5>2.2-5 JUPVIZRunJavaScriptUsingRunGAP</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; JUPVIZRunJavaScriptUsingRunGAP</code>( <var class="Arg">jsCode</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: an object that, if rendered in a Jupyter notebook, will run <var class="Arg">jsCode</var> as JavaScript after <code class="code">runGAP</code> has been defined</p>

<p>There is a JavaScript function called <code class="code">runGAP</code>, defined in the <code class="file">using-runGAP.js</code> file distributed with this package. That function makes it easy to make callbacks from JavaScript in a Jupyter notebook to the <strong class="pkg">GAP</strong> kernel underneath that notebook. This <strong class="pkg">GAP</strong> function runs the given <var class="Arg">jsCode</var> in the notebook, but only after ensuring that <code class="code">runGAP</code> is defined globally in that notebook, so that <var class="Arg">jsCode</var> can call <code class="code">runGAP</code> as needed.</p>

<p>Here is an example use, from JavaScript, of the <code class="code">runGAP</code> function.</p>


<div class="example"><pre>
var calculation = "2^50";
runGAP( calculation + ";", function ( result, error ) {
    if ( result )
        alert( calculation + "=" + result );
    else
        alert( "There was an error: " + error );
} );
</pre></div>

<p><a id="X79B7692C7F543161" name="X79B7692C7F543161"></a></p>

<h5>2.2-6 JUPVIZRunJavaScriptUsingLibraries</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; JUPVIZRunJavaScriptUsingLibraries</code>( <var class="Arg">libraries</var>, <var class="Arg">jsCode</var> )</td><td class="tdright">(&nbsp;function&nbsp;)</td></tr></table></div>
<p>Returns: an object that, if rendered in a Jupyter notebook, will run <var class="Arg">jsCode</var> as JavaScript after all <var class="Arg">libraries</var> have been loaded</p>

<p>There are a set of JavaScript libraries stored in the <code class="file">lib/js/</code> subfolder of this package's installation folder. The Jupyter notebook does not, by default, know about any of those libraries. This <strong class="pkg">GAP</strong> function runs the given <var class="Arg">jsCode</var> in the notebook, but only after ensuring that all JavaScript files on the list <var class="Arg">libraries</var> have been loaded, so that <var class="Arg">jsCode</var> can make use of the functions and variables that they define.</p>

<p>If the first parameter is given as a string instead of a list of strings, it is treated as a list of just one string.</p>


<div class="example"><pre>
JUPVIZRunJavaScriptUsingLibraries( [ "mylib.js" ],
    "alert( 'My Lib defines foo to be: ' + window.foo );" );
# Equivalently:
JUPVIZRunJavaScriptUsingLibraries( "mylib.js",
    "alert( 'My Lib defines foo to be: ' + window.foo );" );
</pre></div>

<p><a id="X7CB82ABE7B3255EB" name="X7CB82ABE7B3255EB"></a></p>

<h4>2.3 <span class="Heading">Representation wrapper</span></h4>

<p>This code is documented for completeness's sake only. It is not needed for clients of this package. Package maintainers may be interested in it in the future.</p>

<p>The <strong class="pkg">JupyterKernel</strong> package defines a method <code class="code">JupyterRender</code> that determines how <strong class="pkg">GAP</strong> data will be shown to the user in the Jupyter notebook interface. When there is no method implemented for a specific data type, the fallback method uses the built-in <strong class="pkg">GAP</strong> method <code class="code">ViewString</code>.</p>

<p>This presents a problem, because we are often transmitting string data (the contents of JavaScript files) from the <strong class="pkg">GAP</strong> kernel to the notebook, and <code class="code">ViewString</code> is not careful about how it escapes characters such as quotation marks, which can seriously mangle code. Thus we must define our own type and <code class="code">JupyterRender</code> method for that type, to prevent the use of <code class="code">ViewString</code>.</p>

<p>The declarations documented below do just that. In the event that <code class="code">ViewString</code> were upgraded to more useful behavior, this workaround could probably be removed. Note that it is used explicitly in the <code class="file">using-library.js</code> file in this package.</p>

<p><a id="X82269732822D224D" name="X82269732822D224D"></a></p>

<h5>2.3-1 JUPVIZIsFileContents</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; JUPVIZIsFileContents</code>( <var class="Arg">arg</var> )</td><td class="tdright">(&nbsp;filter&nbsp;)</td></tr></table></div>
<p>Returns: <code class="code">true</code> or <code class="code">false</code></p>

<p>The type we create is called <code class="code">FileContents</code>, because that is our purpose for it (to preserve, unaltered, the contents of a text file).</p>

<p><a id="X84D70ACD7A72AA84" name="X84D70ACD7A72AA84"></a></p>

<h5>2.3-2 JUPVIZIsFileContentsRep</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; JUPVIZIsFileContentsRep</code>( <var class="Arg">arg</var> )</td><td class="tdright">(&nbsp;filter&nbsp;)</td></tr></table></div>
<p>Returns: <code class="code">true</code> or <code class="code">false</code></p>

<p>The representation for the <code class="code">FileContents</code> type</p>

<p><a id="X7D401DB582A5EBA2" name="X7D401DB582A5EBA2"></a></p>

<h5>2.3-3 JUPVIZFileContents</h5>

<div class="func"><table class="func" width="100%"><tr><td class="tdleft"><code class="func">&#8227; JUPVIZFileContents</code>( <var class="Arg">arg</var> )</td><td class="tdright">(&nbsp;operation&nbsp;)</td></tr></table></div>
<p>A constructor for <code class="code">FileContents</code> objects</p>

<p>Elsewhere, the <strong class="pkg">JupyterViz</strong> package also installs a <code class="code">JupyterRender</code> method for <code class="code">FileContents</code> objects that just returns their text content untouched.</p>


<div class="chlinkprevnextbot">&nbsp;<a href="chap0_mj.html">[Top of Book]</a>&nbsp;  <a href="chap0_mj.html#contents">[Contents]</a>&nbsp;  &nbsp;<a href="chap1_mj.html">[Previous Chapter]</a>&nbsp;  &nbsp;<a href="chap3_mj.html">[Next Chapter]</a>&nbsp;  </div>


<div class="chlinkbot"><span class="chlink1">Goto Chapter: </span><a href="chap0_mj.html">Top</a>  <a href="chap1_mj.html">1</a>  <a href="chap2_mj.html">2</a>  <a href="chap3_mj.html">3</a>  <a href="chapInd_mj.html">Ind</a>  </div>

<hr />
<p class="foot">generated by <a href="http://www.math.rwth-aachen.de/~Frank.Luebeck/GAPDoc">GAPDoc2HTML</a></p>
</body>
</html>
